<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>è¨ºæ–­ã‚°ãƒ©ãƒ•ä½œæˆãƒ„ãƒ¼ãƒ«ï¼ˆä¸Šå¸ï¼‹éƒ¨ä¸‹ï¼‹è·é›¢æ¸¬å®šï¼‰</title>
<style>
body { 
    font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', 'Hiragino Sans', Meiryo, sans-serif;
    margin: 0;
    padding: 20px;
    background-color: #f4f7f6; /* å°‘ã—èƒŒæ™¯è‰²ã‚’ä»˜ã‘ã‚‹ */
    color: #333;
    line-height: 1.6;
}
.container { /* å…¨ä½“ã‚’å›²ã‚€ã‚³ãƒ³ãƒ†ãƒŠ */
    max-width: 900px;
    margin: 0 auto;
    background-color: #fff;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}
h1 {
    color: #007bff;
    text-align: center;
    margin-bottom: 10px;
    font-size: 1.8em;
}
.version-info { /* ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    font-size: 0.8em;
    color: #888;
    text-align: center;
    margin-bottom: 25px;
}

/* ãƒ•ã‚©ãƒ¼ãƒ ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
.form-section {
    background-color: #ffffff;
    padding: 20px;
    border-radius: 8px;
    margin-bottom: 25px;
    border: 1px solid #e0e0e0;
}
.form-section label {
    display: block; /* ãƒ©ãƒ™ãƒ«ã‚’ãƒ–ãƒ­ãƒƒã‚¯è¦ç´ ã« */
    margin-bottom: 8px;
    font-weight: bold;
    color: #555;
    font-size: 0.95em;
}
textarea, input[type="text"] {
    width: 100%;
    box-sizing: border-box;
    padding: 10px;
    margin-bottom: 15px;
    border: 1px solid #ccc;
    border-radius: 4px;
    font-size: 0.9em;
}
textarea {
    min-height: 120px; /* å°‘ã—é«˜ã•ã‚’å‡ºã™ */
    resize: vertical; /* ç¸¦æ–¹å‘ã®ã¿ãƒªã‚µã‚¤ã‚ºå¯ */
}

button, .button-like { /* ãƒœã‚¿ãƒ³å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
    padding: 10px 20px;
    font-weight: bold;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    text-decoration: none; /* aã‚¿ã‚°ç”¨ */
    display: inline-block; /* aã‚¿ã‚°ç”¨ */
    transition: background-color 0.2s ease-in-out;
}
button.primary, .button-like.primary { /* ãƒ¡ã‚¤ãƒ³ãƒœã‚¿ãƒ³ */
    background-color: #007bff;
    margin-top: 10px;
}
button.primary:hover, .button-like.primary:hover {
    background-color: #0056b3;
}
button.secondary, .button-like.secondary { /* ã‚µãƒ–ãƒœã‚¿ãƒ³ */
    background-color: #6c757d;
    font-size: 0.85em;
    padding: 6px 12px;
}
button.secondary:hover, .button-like.secondary:hover {
    background-color: #545b62;
}

.graph-controls summary { /* è©³ç´°è¨­å®šã®è¦‹ãŸç›® */
    font-weight: bold;
    cursor: pointer;
    padding: 10px;
    background-color: #e9ecef;
    border-radius: 4px;
    margin-bottom: 10px;
    display: block; /* ã‚¯ãƒªãƒƒã‚¯ç¯„å›²ã‚’åºƒã’ã‚‹ */
    color: #333;
}
.graph-controls summary:hover {
    background-color: #dde2e6;
}
.graph-controls[open] summary { /* é–‹ã„ãŸæ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ« */
    background-color: #007bff;
    color: white;
}
.highlight-select-area, .visibility-select-area {
    margin-top: 10px;
    margin-bottom: 15px;
    padding: 15px;
    border: 1px solid #e0e0e0;
    background-color: #fdfdfd;
    border-radius: 4px;
}
.highlight-select-area h4, .visibility-select-area h4 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1em;
    color: #007bff;
}
.highlight-select-area label, .visibility-select-area label, .distance-form-area label {
    margin-right: 5px;
    font-size: 0.9em;
    color: #555;
}
.highlight-select-area select, .visibility-select-area select, .distance-form-area select {
    margin-right: 10px;
    padding: 6px 8px; /* å°‘ã—ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°ã‚’èª¿æ•´ */
    border-radius: 4px;
    border: 1px solid #ccc;
    background-color: white;
    margin-bottom: 5px; /* ã‚¹ãƒãƒ›è¡¨ç¤ºã§æ”¹è¡Œã•ã‚ŒãŸæ™‚ã®ãŸã‚ */
}
.visibility-checkbox-list {
    display: flex;
    flex-wrap: wrap;
    gap: 8px 15px;
    margin-top: 8px;
}
.visibility-checkbox-list label {
    display: inline-flex;
    align-items: center;
    margin-right: 10px;
    font-size: 0.9em;
    cursor: pointer;
}
.visibility-checkbox-list input[type="checkbox"] {
    margin-right: 5px;
    cursor: pointer;
}

.download-box, .distance-form-area, .control-group {
    margin-top: 20px;
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    background-color: #f9f9f9;
}
.download-box h3, .distance-form-area h4, .control-group h3 { /* è¦‹å‡ºã—ã‚¹ã‚¿ã‚¤ãƒ«çµ±ä¸€ */
    margin-top: 0;
    margin-bottom: 12px;
    font-size: 1.2em;
    color: #0056b3;
    border-bottom: 1px solid #ddd;
    padding-bottom: 8px;
}
.download-box a {
    font-weight: normal; /* å°‘ã—ç´°ã */
    color: #007bff;
    text-decoration: none;
    display: block; 
    margin-bottom: 8px;
    padding: 5px 0;
}
.info-text {
    font-size: 0.85em;
    color: #555;
    margin-top: 8px;
    margin-bottom: 15px;
    padding-left: 10px;
    border-left: 3px solid #007bff;
}
.graph-container {
    margin-top:15px;
    margin-bottom:25px;
    padding: 10px;
    border: 1px solid #eee;
    background-color: #fff;
}
.section-separator {
    margin-top: 30px;
    margin-bottom: 30px;
    border: 0;
    border-top: 1px solid #007bff;
}

/* ã‚¹ãƒãƒ›è¡¨ç¤ºç”¨ã®èª¿æ•´ */
@media (max-width: 768px) { /* å°‘ã—åºƒã‚ã®ãƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆ */
    body { padding: 10px; }
    .container { padding: 15px; }
    h1 { font-size: 1.6em; }
    .highlight-select-area select, .visibility-select-area select, .distance-form-area select {
        width: 100%; /* ã‚¹ãƒãƒ›ã§ã¯å¹…ã„ã£ã±ã„ã« */
        margin-right: 0;
        margin-bottom: 8px;
    }
    .highlight-select-area label, .visibility-select-area label, .distance-form-area label {
        display: block; 
        margin-bottom: 3px;
    }
    .visibility-checkbox-list label {
        width: calc(50% - 10px); /* ã‚¹ãƒãƒ›ã§ã¯2åˆ—è¡¨ç¤º */
    }
    .download-box ul { padding-left: 10px; }
    .distance-form-area button { width: 100%; }
}

</style>
</head>
<body>
<div class="container"> {# å…¨ä½“ã‚’å›²ã‚€ã‚³ãƒ³ãƒ†ãƒŠ #}
    <h1>è¨ºæ–­ã‚°ãƒ©ãƒ•ä½œæˆãƒ„ãƒ¼ãƒ«</h1>
    <p class="version-info">{{ version }}</p>

    <form method="POST" id="mainForm" class="form-section">
        <label for="numbers">ãƒ‡ãƒ¼ã‚¿å…¥åŠ› (åå‰[ã‚¿ãƒ–]ç•ªå·[ã‚¿ãƒ–]12æ•°å€¤ãƒ‡ãƒ¼ã‚¿):</label>
        <textarea id="numbers" name="numbers" rows="10" placeholder="ä¾‹:
å±±ç”°å¤ªéƒ	1	37	27	40	34	37	30	29	25	30	21	37	33
ä½è—¤èŠ±å­	2	33	23	29	18	32	13	32	37	32	8	40	28" required>{{ request.form.numbers }}</textarea>

        <label for="filename"><strong>ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆç”»åƒã®å‡ºåŠ›åï¼‰:</strong></label>
        <input type="text" id="filename" name="filename" placeholder="ä¾‹: è¨ºæ–­çµæœ (æœªå…¥åŠ›ã§ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå)" value="{{ filename }}">

        <details class="graph-controls">
            <summary>è©³ç´°è¨­å®šï¼ˆå¼·èª¿è¡¨ç¤ºãƒ»è¡¨ç¤ºç‚¹é¸æŠï¼‰</summary>
            <div class="highlight-select-area">
                <h4>å¼·èª¿è¡¨ç¤ºã™ã‚‹ç‚¹ï¼ˆä¸Šå¸ã‚°ãƒ©ãƒ•ï¼‰</h4>
                <label for="highlight_point1_j">å¼·èª¿ç‚¹â‘ (èµ¤):</label>
                <select id="highlight_point1_j" name="highlight_point1_j">
                    <option value="" {% if not highlight_point1_j %}selected{% endif %}>ãªã—</option>
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if highlight_point1_j == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                </select>
                <label for="highlight_point2_j">å¼·èª¿ç‚¹â‘¡(é’):</label>
                <select id="highlight_point2_j" name="highlight_point2_j">
                    <option value="" {% if not highlight_point2_j %}selected{% endif %}>ãªã—</option>
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if highlight_point2_j == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                </select>
                <label for="highlight_point3_j">å¼·èª¿ç‚¹â‘¢(é»„):</label>
                <select id="highlight_point3_j" name="highlight_point3_j">
                    <option value="" {% if not highlight_point3_j %}selected{% endif %}>ãªã—</option>
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if highlight_point3_j == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                </select>
            </div>
            <div class="highlight-select-area">
                <h4>å¼·èª¿è¡¨ç¤ºã™ã‚‹ç‚¹ï¼ˆéƒ¨ä¸‹ã‚°ãƒ©ãƒ•ï¼‰</h4>
                <label for="highlight_point1_b">å¼·èª¿ç‚¹â‘ (èµ¤):</label>
                <select id="highlight_point1_b" name="highlight_point1_b">
                    <option value="" {% if not highlight_point1_b %}selected{% endif %}>ãªã—</option>
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if highlight_point1_b == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                </select>
                <label for="highlight_point2_b">å¼·èª¿ç‚¹â‘¡(é’):</label>
                <select id="highlight_point2_b" name="highlight_point2_b">
                    <option value="" {% if not highlight_point2_b %}selected{% endif %}>ãªã—</option>
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if highlight_point2_b == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                </select>
                <label for="highlight_point3_b">å¼·èª¿ç‚¹â‘¢(é»„):</label>
                <select id="highlight_point3_b" name="highlight_point3_b">
                    <option value="" {% if not highlight_point3_b %}selected{% endif %}>ãªã—</option>
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if highlight_point3_b == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                </select>
            </div>
            <div class="visibility-select-area">
                <h4>è¡¨ç¤ºã™ã‚‹ç‚¹ã‚’é¸æŠï¼ˆä¸Šå¸ã‚°ãƒ©ãƒ•ï¼‰</h4>
                <button type="button" class="secondary" onclick="toggleCheckboxes('visible_points_j_', true, {{ max_points }})">å…¨ã¦è¡¨ç¤º</button>
                <button type="button" class="secondary" onclick="toggleCheckboxes('visible_points_j_', false, {{ max_points }})">å…¨ã¦éè¡¨ç¤º</button>
                <div class="visibility-checkbox-list">
                    {% for i in range(1, max_points + 1) %}<label for="visible_points_j_{{ i }}"><input type="checkbox" id="visible_points_j_{{ i }}" name="visible_points_j" value="{{ i }}" {% if i|string in visible_points_j_selected or not visible_points_j_selected and max_points > 0 %}checked{% endif %}> {{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</label>{% endfor %}
                </div>
                <p class="info-text">â€»ã€Œå…¨ã¦éè¡¨ç¤ºã€ã®çŠ¶æ…‹ã§ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆã™ã‚‹ã¨ã€å…¨ã¦ã®ç‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
            </div>
            <div class="visibility-select-area">
                <h4>è¡¨ç¤ºã™ã‚‹ç‚¹ã‚’é¸æŠï¼ˆéƒ¨ä¸‹ã‚°ãƒ©ãƒ•ï¼‰</h4>
                <button type="button" class="secondary" onclick="toggleCheckboxes('visible_points_b_', true, {{ max_points }})">å…¨ã¦è¡¨ç¤º</button>
                <button type="button" class="secondary" onclick="toggleCheckboxes('visible_points_b_', false, {{ max_points }})">å…¨ã¦éè¡¨ç¤º</button>
                <div class="visibility-checkbox-list">
                    {% for i in range(1, max_points + 1) %}<label for="visible_points_b_{{ i }}"><input type="checkbox" id="visible_points_b_{{ i }}" name="visible_points_b" value="{{ i }}" {% if i|string in visible_points_b_selected or not visible_points_b_selected and max_points > 0 %}checked{% endif %}> {{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</label>{% endfor %}
                </div>
                <p class="info-text">â€»ã€Œå…¨ã¦éè¡¨ç¤ºã€ã®çŠ¶æ…‹ã§ã‚°ãƒ©ãƒ•ã‚’ç”Ÿæˆã™ã‚‹ã¨ã€å…¨ã¦ã®ç‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
            </div>
        </details>
        <button type="submit" name="mode" value="graph" class="primary">ğŸ“Š ã‚°ãƒ©ãƒ•ç”Ÿæˆï¼‹ç”»åƒä¿å­˜</button>
    </form> 

    <hr class="section-separator"> 

    {% if chart_html_j or chart_html_b %} 
        <div class="download-box">
        <h3>ğŸ“¥ ã‚°ãƒ©ãƒ•ç”»åƒã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</h3>
        <ul style="list-style: none; padding-left: 0;">
            <li>
            {% if filename %}
            <a href="{{ url_for('download_file', filename=filename + '_ä¸Šå¸.png') }}" download>
            ğŸ“· ä¸Šå¸ã‚°ãƒ©ãƒ•ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆ{{ filename }}_ä¸Šå¸.pngï¼‰
            </a>
            {% else %}
            <a href="{{ url_for('download_file', filename='ä¸Šå¸.png') }}" download>
            ğŸ“· ä¸Šå¸ã‚°ãƒ©ãƒ•ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆä¸Šå¸.pngï¼‰
            </a>
            {% endif %}
            </li>
            <li>
            {% if filename %}
            <a href="{{ url_for('download_file', filename=filename + '_éƒ¨ä¸‹.png') }}" download>
            ğŸ“· éƒ¨ä¸‹ã‚°ãƒ©ãƒ•ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆ{{ filename }}_éƒ¨ä¸‹.pngï¼‰
            </a>
            {% else %}
            <a href="{{ url_for('download_file', filename='éƒ¨ä¸‹.png') }}" download>
            ğŸ“· éƒ¨ä¸‹ã‚°ãƒ©ãƒ•ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼ˆéƒ¨ä¸‹.pngï¼‰
            </a>
            {% endif %}
            </li>
        </ul>
        </div>
        <hr>

        <h2>è¨ºæ–­çµæœã‚°ãƒ©ãƒ•</h2>
        <hr>

        <div class="control-group">
            <h3>ä¸Šå¸ã‚°ãƒ©ãƒ• æ“ä½œ</h3>
            <div class="distance-form-area">
                <h4>è·é›¢æ¸¬å®š</h4>
                <form method="POST"> 
                    <input type="hidden" name="numbers" value="{{ request.form.numbers }}">
                    <input type="hidden" name="filename" value="{{ filename }}">
                    <input type="hidden" name="highlight_point1_j" value="{{ highlight_point1_j }}">
                    <input type="hidden" name="highlight_point2_j" value="{{ highlight_point2_j }}">
                    <input type="hidden" name="highlight_point3_j" value="{{ highlight_point3_j }}">
                    <input type="hidden" name="highlight_point1_b" value="{{ highlight_point1_b }}">
                    <input type="hidden" name="highlight_point2_b" value="{{ highlight_point2_b }}">
                    <input type="hidden" name="highlight_point3_b" value="{{ highlight_point3_b }}">
                    {% for i in range(1, max_points + 1) %}
                        {% if i|string in visible_points_j_selected or not visible_points_j_selected and max_points > 0 %}<input type="hidden" name="visible_points_j" value="{{ i }}">{% endif %}
                        {% if i|string in visible_points_b_selected or not visible_points_b_selected and max_points > 0 %}<input type="hidden" name="visible_points_b" value="{{ i }}">{% endif %}
                    {% endfor %}
                    <label>ç‚¹ç•ªå·â‘ ï¼š</label>
                    <select name="point1_j">
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if selected1_j == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                    </select>
                    <label>ç‚¹ç•ªå·â‘¡ï¼š</label>
                    <select name="point2_j">
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if selected2_j == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                    </select>
                    <button type="submit" class="secondary">è·é›¢æ¸¬å®š</button>
                </form>
                {% if distance_result_j %}
                <p style="font-weight: bold;">{{ distance_result_j }}</p>
                {% endif %}
            </div>
        </div>
        {% if chart_html_j %} 
            <div class="graph-container">{{ chart_html_j|safe }}</div>
        {% endif %}

        <hr style="margin-top: 30px; margin-bottom: 30px;">

        <div class="control-group">
            <h3>éƒ¨ä¸‹ã‚°ãƒ©ãƒ• æ“ä½œ</h3>
            <div class="distance-form-area">
                <h4>è·é›¢æ¸¬å®š</h4>
                <form method="POST"> 
                    <input type="hidden" name="numbers" value="{{ request.form.numbers }}">
                    <input type="hidden" name="filename" value="{{ filename }}">
                    <input type="hidden" name="highlight_point1_j" value="{{ highlight_point1_j }}">
                    <input type="hidden" name="highlight_point2_j" value="{{ highlight_point2_j }}">
                    <input type="hidden" name="highlight_point3_j" value="{{ highlight_point3_j }}">
                    <input type="hidden" name="highlight_point1_b" value="{{ highlight_point1_b }}">
                    <input type="hidden" name="highlight_point2_b" value="{{ highlight_point2_b }}">
                    <input type="hidden" name="highlight_point3_b" value="{{ highlight_point3_b }}">
                    {% for i in range(1, max_points + 1) %}
                        {% if i|string in visible_points_j_selected or not visible_points_j_selected and max_points > 0 %}<input type="hidden" name="visible_points_j" value="{{ i }}">{% endif %}
                        {% if i|string in visible_points_b_selected or not visible_points_b_selected and max_points > 0 %}<input type="hidden" name="visible_points_b" value="{{ i }}">{% endif %}
                    {% endfor %}
                    <label>ç‚¹ç•ªå·â‘ ï¼š</label>
                    <select name="point1_b">
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if selected1_b == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                    </select>
                    <label>ç‚¹ç•ªå·â‘¡ï¼š</label>
                    <select name="point2_b">
                    {% for i in range(1, max_points + 1) %}<option value="{{ i }}" {% if selected2_b == i|string %}selected{% endif %}>{{ i }}: {{ names_list[i-1] if names_list and i-1 < names_list|length else i }}</option>{% endfor %}
                    </select>
                    <button type="submit" class="secondary">è·é›¢æ¸¬å®š</button>
                </form>
                {% if distance_result_b %}
                <p style="font-weight: bold;">{{ distance_result_b }}</p>
                {% endif %}
            </div>
        </div>
        {% if chart_html_b %} 
            <div class="graph-container">{{ chart_html_b|safe }}</div>
        {% endif %}
    {% endif %}

    {% if error_message %}
    <p style="color: red; font-weight: bold;">{{ error_message }}</p>
    {% endif %}
</div> {# container ã®é–‰ã˜ã‚¿ã‚° #}
<script>
function toggleCheckboxes(prefix, checkedState, maxPoints) {
    for (let i = 1; i <= maxPoints; i++) {
        const checkbox = document.getElementById(prefix + i);
        if (checkbox) {
            checkbox.checked = checkedState;
        }
    }
}
</script>
</body>
</html>
